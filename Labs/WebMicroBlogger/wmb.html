<head>
<title> UTweeter home page </title>
<link rel="stylesheet type="text/css" href="wmb.css">

<script src="jquery.min.js"></script>

<script>
function getpostings() 
{
  alert("getpostings is not implemented");
}
</script>

<script>
function querypostings() 
{
 var jsonreq = {};
 jsonreq["type"] = "QUERY";
 jsonreq["author"] = document.queryform.elements["name"].value;
 jsonreq["subject"] = document.queryform.elements["subject"].value;
 jsonreq["body"] = document.queryform.elements["body"].value;
 jsonreq["latitude"] = document.queryform.elements["latitude"].value;
 jsonreq["longitude"] = document.queryform.elements["longitude"].value;
 jsonreq["distance"] = document.queryform.elements["distance"].value;
 jsonreq["pageoffset"] = document.queryform.elements["pageoffset"].value;
 jsonreq["pagesize"] = document.queryform.elements["pagesize"].value;
 var jsonreqstring = JSON.stringify(jsonreq);

 // change to getJSON for json return case
 var tmp = $.getJSON("http://localhost:16667/queryServlet?queryString=" + jsonreqstring, 
      function(data) {
       console.log(data);
       var postingList = data.postings;
       for ( i = 0 ; i < data.postings.length && i < 4; i++ ) {
         $("#para" + i + "auth").html(postingList[i].author);
         $("#para" + i + "subject").html(postingList[i].subject);
         $("#para" + i + "body").html(postingList[i].body);
       }
     })
    .error(function() { alert("error in btnname handler" ); })
    //.complete(function() { alert("complete" + data); })
    ;
};
</script>

<script>
function submitposting() 
{
 // alert("document.nameform.firstname:" + document.queryform.elements["firstname"].value);
 //$("#submitresults").html(document.nameform.elements["firstname"].value);
 var jsonreq = {};
 jsonreq["type"] = "CREATE";
 jsonreq["author"] = document.createform.elements["name"].value;
 jsonreq["subject"] = document.createform.elements["subject"].value;
 jsonreq["body"] = document.createform.elements["body"].value;
 jsonreq["latitude"] = document.createform.elements["latitude"].value;
 jsonreq["longitude"] = document.createform.elements["longitude"].value;
 // {"type":"CREATE","author":"AdnanAziz1968","id":0,"time":0}
 var jsonreqstring = JSON.stringify(jsonreq);
 alert("jsonreqstring stringified:" + JSON.stringify(jsonreq));

  // change to getJSON for json return case
 var airports = $.getJSON("http://localhost:16667/queryServlet?queryString=" + jsonreqstring, 
      function(data) {
       // alert("success:" + JSON.stringify(data));
       console.log(data);
       var postingList = data.postings;
       //alert("data.postings[0].value = " + data.postings[0].author);
       for ( i = 0 ; i < data.postings.length && i < 4; i++ ) {
         $("#para" + i + "auth").html(postingList[i].author);
         $("#para" + i + "subject").html(postingList[i].subject);
         $("#para" + i + "body").html(postingList[i].body);
         //$("#submitresults").html(data);
       }
     })
    //.success(function() { alert("second success"); })
    .error(function() { alert("error in btnname handler" ); })
    //.complete(function() { alert("complete" + data); })
    ;
};
</script>

<script>
$(document).ready(function(){
  $("#btn0").click(function(){
    submitposting();
  });
});
</script>

<script>
$(document).ready(function(){
  $("#btn1").click(function(){
    queryposting();
  });
});
</script>


<script>
$(document).ready(function(){
  $("#btn2").click(function(){
    var serverMsg = {
      "id":0,
      "postings":[
          {"id":0,"date":"12/3/2012","latitude":"123.4","longitude":"34.41","body":"A random posting.","subject":"Hello World!","author":"Adnan Aziz","authorLikes":123,"postingUpvotes":12},
          {"id":0,"date":"12/2/2012","latitude":"123.4","longitude":"34.41","body":"My first posting.","subject":"99.97!","author":"Don Bradman","authorLikes":123,"postingUpvotes":12},
          {"id":0,"date":"11/3/2012","latitude":"123.4","longitude":"34.41","body":"Why do I always lose the big games?","subject":"Number 1","author":"Graham Smith","authorLikes":123,"postingUpvotes":12},
          {"id":0,"date":"11/2/2012","latitude":"123.4","longitude":"34.41","body":"365 wickets, best in the world","subject":"All rounder!","author":"Ian Botham","authorLikes":939,"postingUpvotes":12},
          {"id":0,"date":"11/2/2012","latitude":"123.4","longitude":"34.41","body":"DSFD FDSF KFD.","subject":"Old timer","author":"Everton Weekes","authorLikes":13,"postingUpvotes":12},
          {"id":0,"date":"11/1/2012","latitude":"123.4","longitude":"34.41","body":"Empty.","subject":"Boring...","author":"Sunny Gavaskar","authorLikes":3443,"postingUpvotes":12}
      ]
    };
    for (var i = 0, len = serverMsg.postings.length; i < len && i < 4; i++) {
     $("#para" + i + "auth").html(serverMsg.postings[i].author);
     $("#para" + i + "subject").html(serverMsg.postings[i].subject);
     $("#para" + i + "body").html(serverMsg.postings[i].body);
     $("#para" + i + "date").html(serverMsg.postings[i].date);
    }
  });
});
</script>

<script>
$(document).ready(function(){
  $("#btn3").click(function(){
    getpostings();
  });
});
</script>



</head>

<body>

<div id="formwrapperdiv">
<table>
<tr>
<td valign="top">
<div id="creatediv">
<h3>Create a posting</h3>
<form name="createform">
<table>
<tr><td>Name</td><td> <input type="text" name="name" value="Default name"></td></tr>
<tr><td>Subject</td><td> <input type="text" name="subject" value="Default value"></td></tr>
<tr><td>Body</td><td> <input type="text" name="body" value="Default body"></td></tr>
<tr><td>Latitude</td><td> <input type="text" name="latitude" value="0.00"></td></tr>
<tr><td>Longitude</td><td> <input type="text" name="longitude" value="0.00"></td></tr>
</table>
</form> 
</div>
</td>

<td valign="top">
<div id="querydiv">
<h3>Query postings</h3>
<form name="queryform">
<table>
<tr> <td>Name</td> <td>  <input type="text" name="name" value="Default name"></tr>
<tr><td>Subject</td> <td>  <input type="text" name="subject" value="Default value"></tr>
<tr><td>Body</td> <td>  <input type="text" name="body" value="Default body"></tr>
<tr><td>Latitude</td> <td>  <input type="text" name="latitude" value="0.00"></tr>
<tr><td>Longitude</td> <td>  <input type="text" name="longitude" value="0.00"></tr>
<tr><td>Distance</td> <td>  <input type="text" name="distance" value="0.00"></tr>
<tr><td>Page size </td> <td> <input type="text" name="pagesize" value="5"></tr>
<tr><td>Page offset</td> <td> <input type="text" name="pageoffset" value="0"></tr>
</table>
</form> 
</div>
</td>

<td valign="top">
<div id="actionsdiv">
<h3>Perform actions</h3>
<!-- 
<a href="javascript: submitposting()">Submit posting</a>
<br>
<a href="javascript: querypostings()">Query postings</a>
<br>
-->
<button id="btn0">Submit posting</button> 
<p>
<button id="btn1">Query postings</button> 
<p>
<button id="btn2">Test get postings locally</button> 
<p>
<button id="btn3">Update postings</button> 
</div>
</td>
</tr>
</table>
</div>


<div id="postingslist">
<h3>List of postings</h3>
<table>
<tr><td id="para0auth"> </td> <td id="para0subject"> </td> <td id="para0body"></td> <td id="para0date"></td> </tr>
<tr><td id="para1auth"> </td> <td id="para1subject"> </td> <td id="para1body"></td> <td id="para1date"></td> </tr>
<tr><td id="para2auth"> </td> <td id="para2subject"> </td> <td id="para2body"></td> <td id="para2date"></td> </tr>
<tr><td id="para3auth"> </td> <td id="para3subject"> </td> <td id="para3body"></td> <td id="para3date"></td> </tr>
</table>
</div>


<p id="testingarea"></p>

</body>
